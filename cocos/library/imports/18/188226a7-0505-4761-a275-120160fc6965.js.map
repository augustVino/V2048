{"version":3,"sources":["../../../../assets/scripts/assets/scripts/GlobalWeChat.js"],"names":["window","WeChat","onRegisterUser","wx","cloud","callFunction","name","data","userinfo","_userinfo","success","console","log","res","G","userInfo","result","length","openid","cc","director","loadScene","fail","error","err","onUpdateScore","_type","score","onSearchScore","callback"],"mappings":";;;;;;AAAAA,OAAOC,MAAP,GAAgB,EAAhB;;AAEA;AACAA,OAAOC,cAAP,GAAwB,qBAAa;AACjC;AACAC,OAAGC,KAAH,CAASC,YAAT,CAAsB;AAClBC,cAAM,OADY;AAElBC,cAAM;AACFC,sBAAUC;AADR,SAFY;AAKlBC,iBAAS,sBAAO;AACZC,oBAAQC,GAAR,CAAY,QAAZ,EAAsBC,GAAtB;AACAC,cAAEC,QAAF,GAAaF,IAAIG,MAAJ,CAAWT,IAAX,CAAgBU,MAAhB,GAAyB,CAAzB,GAA6BJ,IAAIG,MAAJ,CAAWT,IAAX,CAAgB,CAAhB,EAAmBC,QAAhD,GAA2DK,IAAIG,MAAJ,CAAWT,IAAX,CAAgBC,QAAxF;AACAM,cAAEC,QAAF,CAAW,QAAX,IAAuBF,IAAIG,MAAJ,CAAWT,IAAX,CAAgBU,MAAhB,GAAyB,CAAzB,GAA6BJ,IAAIG,MAAJ,CAAWT,IAAX,CAAgB,CAAhB,EAAmBW,MAAhD,GAAyDL,IAAIG,MAAJ,CAAWT,IAAX,CAAgBW,MAAhG;;AAEA;AACAC,eAAGC,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACH,SAZiB;AAalBC,cAAM,mBAAO;AACTX,oBAAQY,KAAR,CAAcC,GAAd;AACH;AAfiB,KAAtB;AAiBH,CAnBD;;AAqBA;AACAvB,OAAOwB,aAAP,GAAuB,iBAAS;AAC5B;AACAtB,OAAGC,KAAH,CAASC,YAAT,CAAsB;AAClBC,cAAM,OADY;AAElBC,cAAM;AACFmB,mBAAO,QADL;AAEFC,wBAFE;AAGFnB,sBAAUM,EAAEC;AAHV,SAFY;AAOlBL,iBAAS,sBAAO;AACZC,oBAAQC,GAAR,CAAY,UAAZ,EAAwBC,GAAxB;AACH,SATiB;AAUlBS,cAAM,mBAAO;AACTX,oBAAQY,KAAR,CAAcC,GAAd;AACH;AAZiB,KAAtB;AAcH,CAhBD;;AAmBA;AACAvB,OAAO2B,aAAP,GAAuB,oBAAY;AAC/B;AACAzB,OAAGC,KAAH,CAASC,YAAT,CAAsB;AAClBC,cAAM,OADY;AAElBC,cAAM;AACFmB,mBAAO,QADL;AAEFlB,sBAAUM,EAAEC;AAFV,SAFY;AAMlBL,iBAAS,sBAAO;AACZC,oBAAQC,GAAR,CAAY,YAAZ,EAA0BC,GAA1B;AACAgB,wBAAYA,SAAShB,IAAIG,MAAb,CAAZ;AACH,SATiB;AAUlBM,cAAM,mBAAO;AACTX,oBAAQY,KAAR,CAAcC,GAAd;AACAK,wBAAYA,SAAS,CAAT,CAAZ;AACH;AAbiB,KAAtB;AAeH,CAjBD","file":"GlobalWeChat.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["window.WeChat = {};\n\n// 微信登录注册调用\nWeChat.onRegisterUser = _userinfo => {\n    // 调用云函数注册\n    wx.cloud.callFunction({\n        name: 'login',\n        data: {\n            userinfo: _userinfo\n        },\n        success: res => {\n            console.log('登录成功回调', res)\n            G.userInfo = res.result.data.length > 0 ? res.result.data[0].userinfo : res.result.data.userinfo;\n            G.userInfo['openId'] = res.result.data.length > 0 ? res.result.data[0].openid : res.result.data.openid;\n\n            // 跳转场景\n            cc.director.loadScene(\"game\");\n        },\n        fail: err => {\n            console.error(err);\n        }\n    })\n};\n\n// 更新用户分数\nWeChat.onUpdateScore = score => {\n    // 调用云函数更新分数\n    wx.cloud.callFunction({\n        name: 'score',\n        data: {\n            _type: 'update',\n            score,\n            userinfo: G.userInfo\n        },\n        success: res => {\n            console.log('更新分数成功回调', res);\n        },\n        fail: err => {\n            console.error(err);\n        }\n    })\n}\n\n\n// 获取用户分数\nWeChat.onSearchScore = callback => {\n    // 调用云函数更新分数\n    wx.cloud.callFunction({\n        name: 'score',\n        data: {\n            _type: 'search',\n            userinfo: G.userInfo\n        },\n        success: res => {\n            console.log('获取用户分数成功回调', res);\n            callback && callback(res.result);\n        },\n        fail: err => {\n            console.error(err);\n            callback && callback(0);\n        }\n    })\n}"]}